#!/bin/bash

# Installing extra third-party libraries
if [ -d "third-party" ]; then
    # Use the provided archives
    echo "Installing third-party libraries ..."
    pip install -q third-party/python-rtmidi-0.5b1.tar.gz
    pip install -q third-party/mido.tar.gz
else
    # Download from pypi
    echo "Installing third-party libraries ..."
    pip install -q --pre --upgrade python-rtmidi
    pip install -q --upgrade mido
fi

echo "Check installation ..."

# Check if "python-rtmidi" is installed
rtmidi_result=`pip list | grep python-rtmidi`

if [[ "$rtmidi_result" == "mido" ]]; then
    >&2 echo "Error: python-rtmidi not installed!"
    exit -1
else
    echo "Found: "$rtmidi_result
fi

# Check if "mido" is installed
mido_result=`pip list | grep mido`

if [[ "$mido_result" != mido* ]]; then
    >&2 echo "Error: mido not installed!"
    exit -1
else
    echo "Found: "$mido_result
fi

# If I'am here it's all ok
exit 0
